# Programming-in-PhaseField-Method---FEM-Code
对***Programming in PhaseField Method***这本书中的有限元法代码进行一个总结

## 代码整体架构
这是一个完整的二维线性弹性有限元求解器，包含从输入到输出的完整流程

## 1.主程序入口：fem_elast_v1.m
主要流程：  
读取输入文件（mesh_1.inp）   
读取有限元数据（节点、单元、材料属性等）   
组装全局刚度矩阵  
组装载荷向量并施加边界条件  
求解线性方程组得到位移  
后处理计算应力  
输出结果  

## 2.输入处理模块：input_fem_elast.m
读取内容：  
控制数据（节点数、单元数、边界条件数等）  
单元节点连接关系和材料编号  
节点坐标  
边界约束信息  
材料属性（弹性模量、泊松比等）  

## 3.核心计算模块
### 3.1 刚度矩阵组装：stiffness.m
原理：  
对每个单元，使用高斯积分计算单元刚度矩阵  
通过形函数、雅可比矩阵、B矩阵和本构矩阵组装单元刚度  
将单元刚度组装到全局刚度矩阵  

### 3.2 载荷处理：loads.m
支持：  
点载荷：直接施加在节点上  
分布载荷：通过边界积分将表面载荷转换为等效节点载荷  

### 3.3 边界条件处理：boundary_cond.m
使用罚函数法或直接修改法施加边界条件

## 4. 辅助计算函数
### 4.1 高斯积分：gauss.m
提供不同阶次的高斯积分点和权重：  
三角形单元：支持1点、3点、7点积分  
四边形单元：支持2点、3点等积分方案

### 4.2 形函数：sfr2.m
计算等参单元的形状函数及其导数，支持：  
3节点三角形单元（线性）  
4节点四边形单元（双线性）  
8节点四边形单元（二次）  

### 4.3 雅可比矩阵：jacob2.m
计算等参变换的雅可比矩阵：  
用于从自然坐标系转换到全局坐标系  
检查雅可比行列式，避免负面积或退化单元  

### 4.4 本构矩阵：modps.m
根据问题类型（平面应力或平面应变）计算弹性本构矩阵：    

## 5.后处理模块
### 5.1 应力计算：stress.m  
根据已求得的位移计算应力  
流程：  
从位移计算应变：ε = B·u  
从应变计算应力：σ = D·ε  

### 5.2 结果输出：output.m 和 write_vtk_fem.m
output.m：将结果写入文本文件（位移、应力等）  
write_vtk_fem.m：生成VTK格式文件，用于可视化（如ParaView）

## 代码特点总结
支持多种单元类型：3节点三角形、4节点和8节点四边形  
支持平面应力和平面应变两种问题类型  
使用等参单元和高斯数值积分  
支持多种载荷类型（点载荷、分布载荷）  
支持边界条件约束  
完整的后处理（应力计算、结果输出、可视化）  
这是一个教学型有限元代码，结构清晰，适合学习和理解有限元法的基本流程。代码涵盖了FEM的核心步骤，是理解相场建模中力学部分的基础

## ===========================分割线=============================
## 输入文件mesh_1介绍





